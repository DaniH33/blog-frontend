{"ast":null,"code":"import _objectSpread from \"/Users/hacktheplanet/Documents/GitHub/blog-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _regeneratorRuntime from \"/Users/hacktheplanet/Documents/GitHub/blog-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/hacktheplanet/Documents/GitHub/blog-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar defaultOptions = {\n  firstDelay: 125,\n  maxDelay: 0,\n  timeMultiple: 2,\n  shouldRetry: function shouldRetry() {\n    return true;\n  }\n};\nvar sleep = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(ms) {\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          return _context.abrupt(\"return\", new Promise(function (s) {\n            return setTimeout(s, ms);\n          }));\n        case 1:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function sleep(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\nvar createExponentialDelayAsyncFn = function createExponentialDelayAsyncFn(opts) {\n  var timesCalled = 0;\n  var calculateDelayInMs = function calculateDelayInMs() {\n    var constant = opts.firstDelay;\n    var base = opts.timeMultiple;\n    var delay = constant * Math.pow(base, timesCalled);\n    return Math.min(opts.maxDelay || delay, delay);\n  };\n  return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return sleep(calculateDelayInMs());\n        case 2:\n          timesCalled++;\n        case 3:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n};\nvar runWithExponentialBackOff = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(callback) {\n    var options,\n      iterationsCount,\n      _defaultOptions$optio,\n      shouldRetry,\n      firstDelay,\n      maxDelay,\n      timeMultiple,\n      delay,\n      _args3 = arguments;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          options = _args3.length > 1 && _args3[1] !== undefined ? _args3[1] : {};\n          iterationsCount = 0;\n          _defaultOptions$optio = _objectSpread(_objectSpread({}, defaultOptions), options), shouldRetry = _defaultOptions$optio.shouldRetry, firstDelay = _defaultOptions$optio.firstDelay, maxDelay = _defaultOptions$optio.maxDelay, timeMultiple = _defaultOptions$optio.timeMultiple;\n          delay = createExponentialDelayAsyncFn({\n            firstDelay: firstDelay,\n            maxDelay: maxDelay,\n            timeMultiple: timeMultiple\n          });\n        case 4:\n          if (!true) {\n            _context3.next = 20;\n            break;\n          }\n          _context3.prev = 5;\n          _context3.next = 8;\n          return callback();\n        case 8:\n          return _context3.abrupt(\"return\", _context3.sent);\n        case 11:\n          _context3.prev = 11;\n          _context3.t0 = _context3[\"catch\"](5);\n          iterationsCount++;\n          if (shouldRetry(_context3.t0, iterationsCount)) {\n            _context3.next = 16;\n            break;\n          }\n          throw _context3.t0;\n        case 16:\n          _context3.next = 18;\n          return delay();\n        case 18:\n          _context3.next = 4;\n          break;\n        case 20:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3, null, [[5, 11]]);\n  }));\n  return function runWithExponentialBackOff(_x2) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport { runWithExponentialBackOff };","map":{"version":3,"names":["defaultOptions","firstDelay","maxDelay","timeMultiple","shouldRetry","sleep","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","ms","wrap","_callee$","_context","prev","next","abrupt","Promise","s","setTimeout","stop","_x","apply","arguments","createExponentialDelayAsyncFn","opts","timesCalled","calculateDelayInMs","constant","base","delay","Math","pow","min","_callee2","_callee2$","_context2","runWithExponentialBackOff","_ref3","_callee3","callback","options","iterationsCount","_defaultOptions$optio","_args3","_callee3$","_context3","length","undefined","_objectSpread","sent","t0","_x2"],"sources":["/Users/hacktheplanet/Documents/GitHub/blog-frontend/node_modules/@clerk/shared/src/utils/runWithExponentialBackOff.ts"],"sourcesContent":["type Milliseconds = number;\n\ntype BackoffOptions = Partial<{\n  firstDelay: Milliseconds;\n  maxDelay: Milliseconds;\n  timeMultiple: number;\n  shouldRetry: (error: unknown, iterationsCount: number) => boolean;\n}>;\n\nconst defaultOptions: Required<BackoffOptions> = {\n  firstDelay: 125,\n  maxDelay: 0,\n  timeMultiple: 2,\n  shouldRetry: () => true,\n};\n\nconst sleep = async (ms: Milliseconds) => new Promise(s => setTimeout(s, ms));\n\nconst createExponentialDelayAsyncFn = (opts: {\n  firstDelay: Milliseconds;\n  maxDelay: Milliseconds;\n  timeMultiple: number;\n}) => {\n  let timesCalled = 0;\n\n  const calculateDelayInMs = () => {\n    const constant = opts.firstDelay;\n    const base = opts.timeMultiple;\n    const delay = constant * Math.pow(base, timesCalled);\n    return Math.min(opts.maxDelay || delay, delay);\n  };\n\n  return async (): Promise<void> => {\n    await sleep(calculateDelayInMs());\n    timesCalled++;\n  };\n};\n\nexport const runWithExponentialBackOff = async <T>(\n  callback: () => T | Promise<T>,\n  options: BackoffOptions = {},\n): Promise<T> => {\n  let iterationsCount = 0;\n  const { shouldRetry, firstDelay, maxDelay, timeMultiple } = {\n    ...defaultOptions,\n    ...options,\n  };\n  const delay = createExponentialDelayAsyncFn({ firstDelay, maxDelay, timeMultiple });\n\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    try {\n      return await callback();\n    } catch (e) {\n      iterationsCount++;\n      if (!shouldRetry(e, iterationsCount)) {\n        throw e;\n      }\n      await delay();\n    }\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}