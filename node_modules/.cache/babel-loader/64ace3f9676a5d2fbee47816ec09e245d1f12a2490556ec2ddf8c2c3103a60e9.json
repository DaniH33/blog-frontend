{"ast":null,"code":"import _classCallCheck from \"/Users/hacktheplanet/Documents/GitHub/blog-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/hacktheplanet/Documents/GitHub/blog-frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nvar KEY_PREFIX = \"__lsbc__\";\nvar LocalStorageBroadcastChannel = /*#__PURE__*/function () {\n  function LocalStorageBroadcastChannel(name) {\n    var _this = this;\n    _classCallCheck(this, LocalStorageBroadcastChannel);\n    this.eventTarget = window;\n    this.postMessage = function (data) {\n      try {\n        localStorage.setItem(_this.channelKey, JSON.stringify(data));\n        localStorage.removeItem(_this.channelKey);\n      } catch (e) {}\n    };\n    this.addEventListener = function (eventName, listener) {\n      _this.eventTarget.addEventListener(_this.prefixEventName(eventName), function (e) {\n        listener(e);\n      });\n    };\n    this.setupLocalStorageListener = function () {\n      var notifyListeners = function notifyListeners(e) {\n        if (e.key !== _this.channelKey || !e.newValue) {\n          return;\n        }\n        try {\n          var data = JSON.parse(e.newValue || \"\");\n          var event = new MessageEvent(_this.prefixEventName(\"message\"), {\n            data: data\n          });\n          _this.eventTarget.dispatchEvent(event);\n        } catch (e2) {}\n      };\n      window.addEventListener(\"storage\", notifyListeners);\n    };\n    this.channelKey = KEY_PREFIX + name;\n    this.setupLocalStorageListener();\n  }\n  _createClass(LocalStorageBroadcastChannel, [{\n    key: \"prefixEventName\",\n    value: function prefixEventName(eventName) {\n      return this.channelKey + eventName;\n    }\n  }]);\n  return LocalStorageBroadcastChannel;\n}();\nexport { LocalStorageBroadcastChannel };","map":{"version":3,"names":["KEY_PREFIX","LocalStorageBroadcastChannel","name","_this","_classCallCheck","eventTarget","window","postMessage","data","localStorage","setItem","channelKey","JSON","stringify","removeItem","e","addEventListener","eventName","listener","prefixEventName","setupLocalStorageListener","notifyListeners","key","newValue","parse","event","MessageEvent","dispatchEvent","e2","_createClass","value"],"sources":["/Users/hacktheplanet/Documents/GitHub/blog-frontend/node_modules/@clerk/shared/src/utils/localStorageBroadcastChannel.ts"],"sourcesContent":["type Listener<T> = (e: MessageEvent<T>) => void;\n\nconst KEY_PREFIX = '__lsbc__';\n\nexport class LocalStorageBroadcastChannel<E> {\n  private readonly eventTarget = window;\n  private readonly channelKey: string;\n\n  constructor(name: string) {\n    this.channelKey = KEY_PREFIX + name;\n    this.setupLocalStorageListener();\n  }\n\n  public postMessage = (data: E): void => {\n    try {\n      localStorage.setItem(this.channelKey, JSON.stringify(data));\n      localStorage.removeItem(this.channelKey);\n    } catch (e) {\n      //\n    }\n  };\n\n  public addEventListener = (eventName: 'message', listener: Listener<E>): void => {\n    this.eventTarget.addEventListener(this.prefixEventName(eventName), e => {\n      listener(e as MessageEvent);\n    });\n  };\n\n  private setupLocalStorageListener = () => {\n    const notifyListeners = (e: StorageEvent) => {\n      if (e.key !== this.channelKey || !e.newValue) {\n        return;\n      }\n\n      try {\n        const data = JSON.parse(e.newValue || '');\n        const event = new MessageEvent(this.prefixEventName('message'), {\n          data,\n        });\n        this.eventTarget.dispatchEvent(event);\n      } catch (e) {\n        //\n      }\n    };\n\n    window.addEventListener('storage', notifyListeners);\n  };\n\n  private prefixEventName(eventName: string): string {\n    return this.channelKey + eventName;\n  }\n}\n"],"mappings":";;AAEA,IAAMA,UAAA,GAAa;AAAA,IAENC,4BAAA;EAIX,SAAAA,6BAAYC,IAAA,EAAc;IAAA,IAAAC,KAAA;IAAAC,eAAA,OAAAH,4BAAA;IAH1B,KAAiBI,WAAA,GAAcC,MAAA;IAQ/B,KAAOC,WAAA,GAAc,UAACC,IAAA,EAAkB;MACtC,IAAI;QACFC,YAAA,CAAaC,OAAA,CAAQP,KAAA,CAAKQ,UAAA,EAAYC,IAAA,CAAKC,SAAA,CAAUL,IAAI,CAAC;QAC1DC,YAAA,CAAaK,UAAA,CAAWX,KAAA,CAAKQ,UAAU;MACzC,SAASI,CAAA,EAAP,CAEF;IACF;IAEA,KAAOC,gBAAA,GAAmB,UAACC,SAAA,EAAsBC,QAAA,EAAgC;MAC/Ef,KAAA,CAAKE,WAAA,CAAYW,gBAAA,CAAiBb,KAAA,CAAKgB,eAAA,CAAgBF,SAAS,GAAG,UAAAF,CAAA,EAAK;QACtEG,QAAA,CAASH,CAAiB;MAC5B,CAAC;IACH;IAEA,KAAQK,yBAAA,GAA4B,YAAM;MACxC,IAAMC,eAAA,GAAkB,SAAlBA,gBAAmBN,CAAA,EAAoB;QAC3C,IAAIA,CAAA,CAAEO,GAAA,KAAQnB,KAAA,CAAKQ,UAAA,IAAc,CAACI,CAAA,CAAEQ,QAAA,EAAU;UAC5C;QACF;QAEA,IAAI;UACF,IAAMf,IAAA,GAAOI,IAAA,CAAKY,KAAA,CAAMT,CAAA,CAAEQ,QAAA,IAAY,EAAE;UACxC,IAAME,KAAA,GAAQ,IAAIC,YAAA,CAAavB,KAAA,CAAKgB,eAAA,CAAgB,SAAS,GAAG;YAC9DX,IAAA,EAAAA;UACF,CAAC;UACDL,KAAA,CAAKE,WAAA,CAAYsB,aAAA,CAAcF,KAAK;QACtC,SAASG,EAAA,EAAP,CAEF;MACF;MAEAtB,MAAA,CAAOU,gBAAA,CAAiB,WAAWK,eAAe;IACpD;IArCE,KAAKV,UAAA,GAAaX,UAAA,GAAaE,IAAA;IAC/B,KAAKkB,yBAAA,CAA0B;EACjC;EAAAS,YAAA,CAAA5B,4BAAA;IAAAqB,GAAA;IAAAQ,KAAA,EAqCQ,SAAAX,gBAAgBF,SAAA,EAA2B;MACjD,OAAO,KAAKN,UAAA,GAAaM,SAAA;IAC3B;EAAA;EAAA,OAAAhB,4BAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}