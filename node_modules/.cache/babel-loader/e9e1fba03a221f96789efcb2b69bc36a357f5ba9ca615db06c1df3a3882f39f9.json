{"ast":null,"code":"import _regeneratorRuntime from\"/Users/hacktheplanet/Documents/GitHub/blog-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/hacktheplanet/Documents/GitHub/blog-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{useNavigate}from\"react-router-dom\";import{RedirectToSignIn,SignedIn,SignedOut,useAuth,useUser}from\"@clerk/clerk-react\";import{useEffect}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NewPost=function NewPost(){var navigateTo=useNavigate();var _useAuth=useAuth(),getToken=_useAuth.getToken;var _useUser=useUser(),user=_useUser.user;useEffect(function(){if(!user||!user.publicMetadata.admin){navigateTo(\"/\");}},[]);//38 When the form is submitted to make a new post\nvar createPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var token,formData,response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();_context.next=3;return getToken();case 3:token=_context.sent;console.log(token);formData=new FormData(event.target);//40 Send the form values to the backend via a post request\n_context.next=8;return fetch(\"http://localhost:3011/newPost\",{method:\"POST\",body:formData,headers:{Authorization:\"Bearer \".concat(token)}});case 8:response=_context.sent;_context.next=11;return response.json();case 11:data=_context.sent;if(data.error){alert(response.error);}//43 After the values are saved into the DB,\n//navigate back to the homepage\nnavigateTo(\"/\");case 14:case\"end\":return _context.stop();}},_callee);}));return function createPost(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(SignedOut,{children:/*#__PURE__*/_jsx(RedirectToSignIn,{})}),/*#__PURE__*/_jsxs(SignedIn,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"New Post\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:createPost,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"title\",className:\"form-label\",children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"title\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"content\",className:\"form-label\",children:\"Content\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",name:\"content\",rows:\"3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"tagline\",className:\"form-label\",children:\"Tagline\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"tagline\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"image\",className:\"form-label\",children:\"Image\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"photo\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-success\",children:\"Create Post\"})]})]})]});};export default NewPost;","map":{"version":3,"names":["useNavigate","RedirectToSignIn","SignedIn","SignedOut","useAuth","useUser","useEffect","jsx","_jsx","jsxs","_jsxs","NewPost","navigateTo","_useAuth","getToken","_useUser","user","publicMetadata","admin","createPost","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","token","formData","response","data","wrap","_callee$","_context","prev","next","preventDefault","sent","console","log","FormData","target","fetch","method","body","headers","Authorization","concat","json","error","alert","stop","_x","apply","arguments","className","children","onSubmit","htmlFor","type","name","rows"],"sources":["/Users/hacktheplanet/Documents/GitHub/blog-frontend/src/NewPost.js"],"sourcesContent":["import { useNavigate } from \"react-router-dom\";\nimport {\n\tRedirectToSignIn,\n\tSignedIn,\n\tSignedOut,\n\tuseAuth,\n\tuseUser,\n} from \"@clerk/clerk-react\";\nimport { useEffect } from \"react\";\nconst NewPost = () => {\n\tconst navigateTo = useNavigate();\n\tconst { getToken } = useAuth();\n\tconst { user } = useUser();\n\n\tuseEffect(() => {\n\t\tif (!user || !user.publicMetadata.admin) {\n\t\t\tnavigateTo(\"/\");\n\t\t}\n\t}, []);\n\n\t//38 When the form is submitted to make a new post\n\tconst createPost = async (event) => {\n\t\tevent.preventDefault();\n\n\t\tconst token = await getToken();\n\t\tconsole.log(token);\n\n\t\tconst formData = new FormData(event.target);\n\n\t\t//40 Send the form values to the backend via a post request\n\t\tconst response = await fetch(`http://localhost:3011/newPost`, {\n\t\t\tmethod: \"POST\",\n\t\t\tbody: formData,\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Bearer ${token}`,\n\t\t\t},\n\t\t});\n\t\tconst data = await response.json();\n\n\t\tif (data.error) {\n\t\t\talert(response.error);\n\t\t}\n\t\t//43 After the values are saved into the DB,\n\t\t//navigate back to the homepage\n\t\tnavigateTo(\"/\");\n\t};\n\n\treturn (\n\t\t<div className=\"container\">\n\t\t\t<SignedOut>\n\t\t\t\t<RedirectToSignIn />\n\t\t\t</SignedOut>\n\t\t\t<SignedIn>\n\t\t\t\t<h1>New Post</h1>\n\t\t\t\t<hr />\n\t\t\t\t<form onSubmit={createPost}>\n\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t<label htmlFor=\"title\" className=\"form-label\">\n\t\t\t\t\t\t\tTitle\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\tname=\"title\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t<label htmlFor=\"content\" className=\"form-label\">\n\t\t\t\t\t\t\tContent\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\tname=\"content\"\n\t\t\t\t\t\t\trows=\"3\"\n\t\t\t\t\t\t></textarea>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t<label htmlFor=\"tagline\" className=\"form-label\">\n\t\t\t\t\t\t\tTagline\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\tname=\"tagline\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t<label htmlFor=\"image\" className=\"form-label\">\n\t\t\t\t\t\t\tImage\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<input type=\"file\" name=\"photo\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<button type=\"submit\" className=\"btn btn-success\">\n\t\t\t\t\t\tCreate Post\n\t\t\t\t\t</button>\n\t\t\t\t</form>\n\t\t\t</SignedIn>\n\t\t</div>\n\t);\n};\n\nexport default NewPost;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}